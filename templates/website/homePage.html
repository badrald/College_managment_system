{% extends 'website/base.html' %} {% load static %} {% block title %}منظومة شؤون الموظفين{% endblock title %} {% block content %}
<style>
  .bgimg {
    background-image: url("{% static 'imges/5303874.jpg' %}");
  }

  /* Style for the login box */

  /* Style for the modal overlay */
  .modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    /* Semi-transparent black */
    z-index: 9999;
    /* Make sure the overlay is above everything else */
  }
</style>
<div class="bgimg d-flex align-items-center justify-content-center text-white">
  <div class="overlay"></div>

  <div class="text-content text-center">
    <h1 class="display-3">منظومة إدارة شؤون الموظفين</h1>
    <hr style="margin: auto; width: 40%" class="bg-white" />
    <p class="lead">ادارة الخدمات الصحية قصر بن غشير</p>
    <!-- Button to trigger the login modal -->
    <div class="mt-4">
      <div class="lazer-effect">
        <a href="#" id="myButton" class="text-lg">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          تسجيل الدخول
          <i class="fas fa-fingerprint"></i>
        </a>
      </div>
    </div>
  </div>

  <!-- Modal overlay -->
  <div class="modal-overlay" id="loginModal">
    <div class="login-box">
      <h2>تسجيل الدخول</h2>
      <form method="POST">
        {% csrf_token %}
        <div id="stautsMsg" class="mb-2"></div>
        <div class="user-box">
          <input type="text" id="username" required="" />
          <label>اسم المستخدم</label>
        </div>
        <div class="user-box">
          <input type="password" id="password" required="" />
          <label>كلمة المرور</label>
        </div>
        <a id="submitBtn" onclick="SubmitEvent" >
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          تسجيل الدخول
        </a>
      </form>
    </div>
  </div>
</div>

{% endblock %} {% block scripts %}
<script>
  window.onload = function(e){
  
  }
  let myButton = document.getElementById("myButton");
  let loginModal = document.getElementById("loginModal");
  let userName= document.getElementById("username");
  let password = document.getElementById("password");
  myButton.addEventListener("click", function (event) {
    // Show the login modal
    loginModal.style.display = "block";
     $("#username").focus();
    });
     userName.addEventListener("keyup", function (e) {
        if (e.key === 'Enter') {
          $("#password").focus();
        }
      })
      password.addEventListener("keyup",(e)=> {
        if(e.key=== 'Enter') $('#submitBtn').click();
      })
  // Close the login modal when clicking outside the form
  loginModal.addEventListener("click", function (event) {
    if (event.target === loginModal) {
      loginModal.style.display = "none";
    }
  });
</script>

<script scr="{% static 'dist/js/loginAjax.js' %}">
  $("#submitBtn").on("click", function (e) {
    e.preventDefault();
    const username = $("#username").val();
    const password = $("#password").val();
    $.ajax({
      type: "POST",
      url: "{% url 'login_view' %}",
      data: {
        username: username,
        password: password,
        csrfmiddlewaretoken: "{{ csrf_token }}",
      },
      success: function (data) {
        // Redirect to the homepage on successful login
        console.log(data);
        $("#stautsMsg").removeClass("text-danger").addClass("text-info");
        $("#stautsMsg").text("تم تسجيل الدخول بنجاح ");
        setTimeout(function () {
          window.location.href = "hr/";
        }, 2000);
      },
      error: function (xhr, status, error) {
        const errorMessage =
          xhr.responseJSON && xhr.responseJSON.error
            ? xhr.responseJSON.error
            : "هناك خطأ في الاتصال ";
        $("#stautsMsg").removeClass("text-info").addClass("text-danger");
        $("#stautsMsg").text(errorMessage);
        $("#username").val("");
        $("#password").val("");
      },
    });
  });
</script>

{% endblock %}